\documentclass{article}

% Packages
\usepackage{fuzz}
\usepackage[margin=1.0in]{geometry}
\usepackage{graphicx}
\usepackage{prooftree}

% Metadata
\title{Final Assignment}
\date{\vspace{-1.0cm}27th February 2024}

% Start
\begin{document}
\maketitle

% Question 1
\section*{Q1}

\subsection*{\small a)}
$(p \land q) \implies (p \iff q)$ is a \textbf{tautology}.

\begin{table}[h!]
\begin{tabular}{|c c c c c|} 
\hline 
$p$ & $q$ & $p \land q$ & $p \iff q$ & $(p \land q) \implies (p \iff q)$ \\
\hline
\em{t} & \em{f} & \em{f} & \em{f} & \em{t}  \\ 
\em{f} & \em{f} & \em{f} & \em{t} & \em{t}  \\
\em{f} & \em{t} & \em{f} & \em{f} & \em{t}  \\
\em{t} & \em{t} & \em{t} & \em{t} & \em{t}  \\
\hline
\end{tabular}
\end{table}

\subsection*{\small b)}
$((p \lor q) \implies r) \implies ( \lnot p \lor ( q \lor r ))$ is a \textbf{tautology}.

\begin{table}[h!]
\begin{tabular}{|c c c c c c c c c|} 
\hline 
$p$ & $q$ & $r$ & $\lnot p$ & $p \lor q$ & $q \lor r$ & $(p \lor q) \implies r$ & $\lnot p \lor (q \lor r)$ & $((p \lor q) \implies r) \implies (\lnot p \lor (q \lor r))$ \\
\hline
\em{t} & \em{f} & \em{f} & \em{f} & \em{t} & \em{f} & \em{f} & \em{f} & \em{t}  \\ 
\em{f} & \em{f} & \em{f} & \em{t} & \em{f} & \em{f} & \em{t} & \em{t} & \em{t}  \\
\em{f} & \em{t} & \em{f} & \em{t} & \em{t} & \em{t} & \em{f} & \em{t} & \em{t}  \\
\em{t} & \em{t} & \em{f} & \em{f} & \em{t} & \em{t} & \em{f} & \em{t} & \em{t}  \\
\em{t} & \em{f} & \em{t} & \em{f} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t}  \\ 
\em{f} & \em{f} & \em{t} & \em{t} & \em{f} & \em{t} & \em{t} & \em{t} & \em{t}  \\
\em{f} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t}  \\
\em{t} & \em{t} & \em{t} & \em{f} & \em{t} & \em{t} & \em{t} & \em{t} & \em{t}  \\
\hline
\end{tabular}
\end{table}

% Question 2
\section*{Q2}

\vspace{0.3cm}
\begin{argue} 
(p \land q) \implies (p \iff q) \vspace{0.2cm}  \\
\iff (\lnot (p \land q)) \lor (p \iff q) & implication-disjunction \\ 
\iff (\lnot (p \land q)) \lor ((p \implies q) \land (q \implies p)) & equivalence-implication \\ 
\iff (\lnot (p \land q)) \lor ((\lnot p \lor q) \land (\lnot q \lor p)) & implication-disjunction \\ 
\iff (\lnot p \lor \lnot q) \lor ((\lnot p \lor q) \land (\lnot q \lor p)) & De Morgan 1 \\
\iff ((\lnot p \lor \lnot q) \lor ((\lnot p \lor q)) \land ((\lnot p \lor \lnot q) \lor (\lnot q \lor p))) & distributivity 2 \\
\iff ((\lnot p \lor \lnot p)) \lor ((\lnot q \lor q) \land ((\lnot p \lor p) \lor (\lnot q \lor \lnot q))) & associativity of $\lor$ \\
\iff ((\lnot p \lor \lnot p) \lor true) \land (true \lor (\lnot q \lor \lnot q)) & excluded middle \\
\iff true \land true & true is the zero of $\lor$ \\
\iff true & true is the unit of $\land$ \\
\end{argue}
\pagebreak

\begin{argue} 
((p \lor q) \implies r) \implies ( \lnot p \lor ( q \lor r )) \vspace{0.2cm} \\
\iff (\lnot ((p \lor q) \implies r)) \lor ( \lnot p \lor ( q \lor r )) & implication-disjunction  \\
\iff (\lnot (\lnot (p \lor q) \lor r)) \lor ( \lnot p \lor ( q \lor r )) & implication-disjunction  \\
\iff ((\lnot \lnot (p \lor q) \land \lnot r)) \lor ( \lnot p \lor ( q \lor r )) & De Morgan 2 \\
\iff ((p \lor q) \land \lnot r) \lor ( \lnot p \lor ( q \lor r )) & negation is an involution \\
\iff (\lnot r \land (p \lor q)) \lor ( \lnot p \lor ( q \lor r ))  & commutativity of $\land$  \\
\iff (\lnot r \land p) \lor (\lnot r \land q) \lor ( \lnot p \lor ( q \lor r )) & distributivity 1 \\
\iff (\lnot r \land p) \lor (\lnot r \land q) \lor (r \lor (\lnot p \lor q)) & associativity or $\lor$ \\
\iff (\lnot r \land p) \lor ((\lnot r \land q) \lor r) \lor (\lnot p \lor q) & associativity or $\lor$ \\
\iff (\lnot r \land p) \lor ((r \lor \lnot r) \land (r \lor q)) \lor (\lnot p \lor q) & distributivity 2 \\
\iff (\lnot r \land p) \lor (true \land (r \lor q)) \lor (\lnot p \lor q) & excluded middle \\
\iff (\lnot r \land p) \lor (r \lor q) \lor (\lnot p \lor q) & true is the unit of $\land$ \\
\iff ((\lnot r \land p) \lor r) \lor (q \lor (\lnot p \lor q)) & associativity or $\lor$ \\
\iff ((r \lor \lnot r) \land (r \lor p)) \lor (q \lor (\lnot p \lor q)) & distributivity 2 \\
\iff (true \land (r \lor p)) \lor (q \lor (\lnot p \lor q)) & excluded middle \\
\iff (r \lor p) \lor (q \lor (\lnot p \lor q)) & true is the unit of $\land$ \\
\iff (r \lor p) \lor (\lnot p \lor (q \lor q)) & associativity or $\lor$ \\
\iff (r \lor p) \lor (\lnot p \lor q) & idempotence or $\lor$ \\
\iff r \lor (p \lor \lnot p) \lor q & associativity or $\lor$ \\
\iff r \lor true \lor q & excluded middle \\
\iff true & true is the zero of $\lor$ \\
\end{argue}

% Question 3
\section*{Q3}
\vspace{0.3cm}

% Tree 1
\settree7{
\starttree{$ (p \land q) \scriptstyle [1] $}
\jstep{$ p $}{$\scriptstyle \land-elim1 $}
}

\settree6{
\starttree{$ [q] \scriptstyle [3] $}
}

\settree5{
\starttree{$ (p \land q) \scriptstyle [1] $}
\jstep{$ q $}{$\scriptstyle  \land-elim2 $}
}

\settree4{
\starttree{$ [p] \scriptstyle [2] $}
}

\settree3{
\jointrees{5}{4}
\jstep{$q \land p$}{$\scriptstyle \land-intro$}
\jstep{$q$}{$\scriptstyle \land elim1$}
\jstep{$p \implies q$}{$\scriptstyle \implies-intro [2]$}
}
\settree2{
\jointrees{7}{6}
\jstep{$p \land q$}{$\scriptstyle \land-intro$}
\jstep{$p$}{$\scriptstyle \land elim1$}
\jstep{$q \implies p$}{$\scriptstyle \implies-intro [3]$}
}
\settree1{
\jointrees{3}{2}
\jstep{$p \iff q$}{$\scriptstyle \iff-intro$}
\jstep{$(p \land q) \implies (p \iff q)$}{$\scriptstyle \implies-intro [1]$}
}
\bigskip

\ligne{\hfill\box1\hfill}
\vspace{1cm} 

% Tree 2
\settree4{
\starttree{$ [r] \scriptstyle [2] $}
\jstep{$ (q \lor r) $}{$\scriptstyle \lor-intro2 $}
\jstep{$ \lnot p \lor (q \lor r) $}{$\scriptstyle \lor-intro2 $}
}

\settree3{ 
\starttree{$ [\lnot p \land \lnot q] \scriptstyle [2]$}
\jstep{$ \lnot p $}{$\scriptstyle \land-elim1 $}
\jstep{$ \lnot p \lor q $}{$\scriptstyle \lor-intro1$}
\jstep{$ \lnot p \lor (q \lor r) $}{$\scriptstyle \lor-intro1$}
}

\settree2{
\starttree{$ [p \lor q \implies r] \scriptstyle [1]$}
\jstep{$ \lnot ( p \lor q) \lor r$}{$\scriptstyle \implies equivalence $}
\jstep{$ (\lnot p \land \lnot q) \lor r $}{$\scriptstyle de\ Morgan1 $}
}

\settree1{
\ljointrees{2}{3}{4}
\jstep{$ \lnot p \lor (q \lor r) $}{$\scriptstyle \lor-elim [2]$}
\jstep{$((p \lor q) \implies r) \implies (\lnot p \lor (q \lor r))$}{$\scriptstyle \implies-intro [1]$}
}
\bigskip
\hspace{-1.2cm} 
\ligne{\hfill\box1\hfill}
\pagebreak

% Question 4
\section*{Q4}
\vspace{0.3cm}

\begin{gendef}[X]
	occurs\_once: \power (\power X) \fun \power X \\
\where
	\forall A: \power (\power X) @ \\
\t1     occurs\_once(A) = \{ x: X \mid (\exists_1 S : A @ x \in S) \}
\end{gendef}

% Question 5
\section*{Q5}
\vspace{0.3cm}

\begin{argue} 
x \mapsto z \in R \semi (S \cup T) \vspace{0.2cm} \\
\iff (\exists y: Y @ x \mapsto y \in R \land y \mapsto z \in (S \cup T)) & equivalence \\
\iff (\exists y: Y @ x \mapsto y \in R \land (y \mapsto z \in S \lor y \mapsto z \in T)) & union \\
\iff (\exists y: Y @ (x \mapsto y \in R \land y \mapsto z \in S) \lor (x \mapsto y \in R \land y \mapsto z \in T)) & distributivity 1 \\ 
\iff (\exists y: Y @ x \mapsto y \in R \land y \mapsto z \in S) \lor (\exists y: Y @ x \mapsto y \in R \land y \mapsto z \in T) & $\exists$ distributes over $\lor$ \\
\iff (x \mapsto z \in R \semi S) \lor (\exists y: Y @ x \mapsto y \in R \land y \mapsto z \in T) & equivalence \\ 
\iff (x \mapsto z \in R \semi S) \lor (x \mapsto z \in R \semi T) & equivalence \\
\iff x \mapsto z \in (R \semi S) \cup (R \semi T) & union \\
\end{argue}

% Question 6
\section*{Q6}
\vspace{0.3cm}

\begin{axdef}
	zoo: \seq Area
\where
	\forall area: (\ran zoo) @ \forall pair: (\dom(area) \cross \dom(area)) @ pair \in compatible \\
	\forall animal: Animal @ \# \{ area: ran(zoo) | animal \inbag area \} \leq 1 \\
	\forall area: (\ran zoo) | area \neq \lbag \rbag @ \bigcap  \{ animal: \dom(area) @ possible\_foods(animal) \} \neq \emptyset
\end{axdef}


% Question 7
\section*{Q7}

\subsection*{\small a)}
\begin{axdef} 
	removeAnimal: Area \cross Animal \pfun Area
\where
	removeAnimal = \lambda a: Area; x: Animal \mid x \inbag a \spot a \uminus \lbag x \rbag \\
\end{axdef}

\subsection*{\small b)}
\begin{axdef} 
	addAnimal: Area \cross Animal \pfun Area
\where
	\forall a: Area; x: Animal \mid \\
		\t1 \{ x \} \cross \dom(a) \subseteq compatible \land \bigcap possible\_foods\ \limg \{ x \} \cup dom(a) \rimg \neq \emptyset \spot  \\
		\t2 addAnimal(a, x) = a \uplus \lbag x \rbag
\end{axdef}
	
\subsection*{\small c)}
\begin{axdef} %use lambda must be in a1 and not in a2, 
	moveAnimal: Area \cross Area \cross Animal \pfun Area \cross Area
\where
\forall a1, a2: Area; x: Animal \mid \\ 
	\t1 (a1, x) \in \dom(removeAnimal) \land (a2, x) \in \dom(addAnimal) \land a1 \bcount x = 1 \spot \\
	\t2 moveAnimal(a1, a2, x) = (removeAnimal(a1, x), addAnimal(a2, x))
\end{axdef}

% Question 8
\section*{Q8}

\subsection*{\small a)}
\begin{axdef}
	present: Colour \cross MixedColour \fun YesNo \\
\where
\forall c1, c2: Colour @ \\
	\t1 (present(c1, base\ c2) = yes) \iff (c1 = c2) \\
	\t1 (present(c1, base\ c2) = no) \iff (c1 \neq c2) \\
\forall c: Colour; m1, m2: MixedColour @ \\
	\t1 present(c, mix(m1, m2)) = present(c, m1)\ Or\ present(c, m2) \\
\end{axdef}


\subsection*{\small b)}
\begin{axdef}
	addcolour: Colour \cross MixedColour \fun MixedColour \\
\where
	\forall c1, c2: Color @ \\
		\t1 addcolour(c1, base\ c2) = mix(base\ c1, base\ c2) \\
	\forall c: Colour; m1, m2: MixedColour @ \\
		\t1 addcolour(c, mix(m1, m2)) = mix(base\ c, mix(m1, m2)) \\
 \end{axdef}

% Question 9
\section*{Q9}
\vspace{0.3cm}

\begin{argue} 
present(c1, addcolour(c1, base\ c2)) \vspace{0.1cm}  \\
= present(c1, mix(base\ c1, base\ c2)) & addcolour \\
= present(c1, base\ c1)\ Or\ present(c1, base\ c2) & present \\
= yes\ Or\ no & present \\
= yes & Or \\
\end{argue}

\begin{argue} 
present(c, addcolour(c, mix(m1, m2))) \vspace{0.1cm}  \\
= present(c, mix(base\ c, mix(m1, m2))) & addcolour \\
= present(c, mix(base\ c, m1))\ Or\ present(c, mix(base\ c, m2)) & distributivity \\
= present(c, addcolour(c, m1))\ Or\ present(c, addcolour(c, m2)) & addcolour \\ 
= yes\ Or\ yes & $P(c, m1) \land P(c, m2)$ \\
= yes & Or \\
\end{argue}
	

% Question 10
\section*{Q10}

\subsection*{\small a)}
\begin{infrule}
P(nil) \\
\forall s: \iseq \nat; l: SeqList \spot P(l) \implies P(join(s, l))
\derive
\forall l: SeqList \spot P(l)
\end{infrule}

\subsection*{\small b)}
\begin{axdef}
	sum\_elements\textsubscript{L}: SeqList \fun \nat
\where
sum\_elements\textsubscript{L}(nil) = 0 \\
\forall s: \iseq \nat; l: SeqList @ \\
	\t1 sum\_elements\textsubscript{L}(join(s, l)) = (\Sigma\ ran(s)) + sum\_elements\textsubscript{L}(l)
\end{axdef}

\subsection*{\small c)}
\begin{axdef}
	transform: SeqList \fun \seq(\iseq \nat)
\where
	transform(nil) = \langle \rangle \\ 
\forall s: \iseq \nat; l: SeqList @ \\
	\t1 transformer(join(s, l)) = \langle s \rangle \cat transform(l)
\end{axdef}


\subsection*{\small d)}
\begin{axdef}
	sum\_elements\textsubscript{S}: \seq(\iseq \nat) \fun \nat
\where
sum\_elements\textsubscript{S}(\langle \rangle) = 0 \\
\forall x: \iseq \nat; s: \seq(\iseq \nat) @ \\
	\t1 sum\_elements\textsubscript{S}(\langle x \rangle \cat s) = (\Sigma\ ran(x)) + sum\_elements\textsubscript{S}(s)
\end{axdef}

\subsection*{\small e)}
\begin{argue} 
sum\_elements\textsubscript{S}(transform(nil)) \vspace{0.1cm}  \\
= sum\_elements\textsubscript{S}(\langle \rangle) & transform \\
= 0 & sum\_elements\textsubscript{S} \\ 
= sum\_elements\textsubscript{L}(nil) & sum\_elements\textsubscript{L}
\end{argue}

\begin{argue} 
sum\_elements\textsubscript{S}(transform(join(s, l))) \vspace{0.1cm}  \\
= sum\_elements\textsubscript{S}(\langle s \rangle \cat transform(l)) & transform \\
= sum\_elements\textsubscript{S}(\langle s \rangle) + sum\_elements\textsubscript{S}(transform(l)) & distributivity \\
= (\Sigma\ ran(s) + sum\_elements\textsubscript{S}(\langle \rangle)) + sum\_elements\textsubscript{S}(transform(l)) &  sum\_elements\textsubscript{S} \\
= (\Sigma\ ran(s) + 0) + sum\_elements\textsubscript{S}(transform(l))  & sum\_elements\textsubscript{S}\\
= (\Sigma\ ran(s)) + sum\_elements\textsubscript{S}(transform(l)) & addition \\
= (\Sigma\ ran(s)) + sum\_elements\textsubscript{L}(l) & inductive assumption \\
= sum\_elements\textsubscript{L}(join(s, l)) & sum\_elements\textsubscript{L}
\end{argue}

\end{document}